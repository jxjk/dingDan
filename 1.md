MD文档：系统功能细化
系统概述
本系统实现基于二维码的任务分发和机床控制，通过任务分发系统协调人、DNC软件和机床，实现自动化加工流程。系统强调GUI控制模拟人类输入，确保不影响人类操作。

组件功能细化
人（操作员）

输入指示书二维码：使用扫描设备将二维码内容输入任务分发系统。

变更机床材料：根据任务分发系统的指示（如GUI提示）手动更换材料。

取出加工产品：在加工完成后，从机床取出成品。

任务分发系统

解析二维码：提取任务信息（如产品ID、数量、材料类型）。

添加新任务：将任务加入队列，并分配唯一ID。

显示状态和进度：在GUI上实时显示任务状态（等待、分配、加工中、完成）和进度条。

读取机床状态：通过监控onoff.txt文件获取机床运行/停止状态。

任务分配逻辑：根据机床加工能力（如材料兼容性、当前负载）和材料库存，分配任务给最优机床。

写入任务字符串：生成宏变量字符串（如#100=1表示任务ID），并通过GUI自动化模拟输入到DNC软件（使用PyAutoGUI或类似工具，确保不干扰人类操作）。

DNC系统

解析任务字符串：从任务分发系统接收字符串，解析宏变量（如加工参数、数量）。

监视onoff.txt：检查机床状态，若机床运行则暂停操作，防止误干预。

更新macro.txt：将解析后的宏变量写入文件，格式为键值对。

DNC传输软件

监视macro.txt：监听文件变化，一旦更新则读取内容。

传输宏变量到机床：通过串口或网络协议将宏变量发送到机床控制器。

读取机床状态：从机床获取实时状态（运行/停止）。

更新onoff.txt：将机床状态写入文件，供其他组件读取。

机床

加工工件：根据宏变量执行加工程序，控制刀具和轴移动。

记录信息：内部记录加工数量、材料使用、状态日志，并更新宏变量。

状态反馈：将状态发送给DNC传输软件。

数据文件说明
onoff.txt：文本文件，存储机床状态（RUN表示运行，STOP表示停止）。用于协调各组件操作。

macro.txt：文本文件，存储宏变量（如#100=1, #101=ALUMINUM）。作为DNC和DNC传输软件之间的数据中介。

GUI控制模拟细节
技术实现：使用Python库（如PyAutoGUI）模拟键盘输入，将任务字符串键入DNC软件的输入框。

不影响人类操作：脚本在后台运行，通过窗口焦点管理避免干扰用户其他活动。例如，仅在检测到DNC软件窗口激活时输入。

安全措施：添加延迟和错误处理，防止输入冲突。

系统流程
人扫描二维码，任务分发系统解析并添加任务。

任务分发系统分配任务，生成任务字符串，通过GUI模拟输入到DNC。

DNC解析字符串，更新macro.txt，并监视onoff.txt确保安全。

DNC传输软件检测macro.txt变化，传输宏变量到机床。

机床加工工件，更新状态，DNC传输软件写入onoff.txt。

任务分发系统读取onoff.txt，更新任务状态显示。

人根据指示更换材料或取出产品。